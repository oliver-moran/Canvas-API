<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Canvas API examples</title>

<script language="javascript" src="canvas_api.js"></script>

</head>

<body>

<canvas id="clock" width="300" height="300"></canvas>

<script language="javascript">

var clock = {
	init : function(){

		// Add the 12 ticks for the hours to the clock
		var tick = new Canvas.Palette.Line(150, 0, 150, 20);
		for (i=0; i<12; i++){
			tick.origin.y = +150;			// Move the origin of the tick to the centre of the clock
			tick.rotation = (360/12)*i;		// Rotate the tick so that it there are tweleve evenly spaced around the clock face
			tick.stroke.color = "grey";
			clock.drawing.add("tick_"+i, tick);
		}

		// Create the three hand for the clock
		var hour_hand = new Canvas.Palette.Line(150, 150, 150, 100);
		hour_hand.stroke.width = 10;
		hour_hand.stroke.color = "grey";
		hour_hand.stroke.cap = "round";
		hour_hand.origin.y = 0;
		clock.drawing.add("hour_hand", hour_hand);

		var minute_hand = new Canvas.Palette.Line(150, 150, 150, 50);	
		minute_hand.stroke.width = 5;
		minute_hand.stroke.color = "darkGrey";
		minute_hand.stroke.cap = "round";
		minute_hand.layer = 2;
		clock.drawing.add("minute_hand", minute_hand);
	
		var second_hand = new Canvas.Palette.Line(150, 150, 150, 20);
		second_hand.stroke.width = 1;
		second_hand.layer = 1;
		clock.drawing.add("second_hand", second_hand);
	
		// Start the animation (the default frame rate in 12 fps)
		clock.drawing.framerate = 1;
		clock.drawing.onBeforeDraw = clock.update;
	},
	
	// This function will act as the callback for the animation
	update : function(){
		// Get the current time and rotate each hand accordingly
		var time = new Date();
		clock.drawing.scene.hour_hand.rotation = (360/12)*(time.getHours())+((360/12)/60)*time.getMinutes();
		clock.drawing.scene.minute_hand.rotation = (360/60)*time.getMinutes()+((360/60)/60)*time.getSeconds();
		clock.drawing.scene.second_hand.rotation = (360/60)*time.getSeconds();
	}
}

</script>

</body>
</html>